# [Encrypt 字符串加解密](http://mid.chinatowercom.cn:18080/appGuide/base/encrypt.html#encrypt-字符串加解密)

封装对字符串的加密解密，包含对称与非对称加解密。

### [非对称加密基本使用](http://mid.chinatowercom.cn:18080/appGuide/base/encrypt.html#非对称加密基本使用)

- 通过`globalData`设置全局共用加解密密钥
- 通过传入`需要加密的文本`参数进行加/解密字符串

```javascript
const encrypt = new this.$ctmobile.secret.encrypt()
// 加密
encrypt.encryptLong('加密字符串')
// 解密
encrypt.decryptLong('解密字符串');
<template>
  <view class="demo">
    <view class="title">非对称加密</view>
    <view class="row">
      <text class="label">公钥信息：</text>
      <textarea class="value" v-model="publicKey" placeholder="公钥信息" maxlength="-1" />
    </view>
    <view class="row">
      <text class="label">私钥信息：</text>
      <textarea class="value" v-model="privateKey" placeholder="私钥信息" maxlength="-1" />
    </view>
    <view class="row">
      <text class="label">明文信息：</text>
      <input class="value" v-model="text" placeholder="明文信息" maxlength="-1" />
    </view>
    <view :class="['row result', {'success': encryptedString}]">
      <view class="crypto-text">加密结果：{{encryptedString}}</view>
    </view>
    <view :class="['row result', {'success': decryptedString}]">
      <view class="crypto-text">解密结果：{{decryptedString}}</view>
    </view>
    <view class="btn-row">
      <button class="btn" @click="initKey">初始化密钥</button>
      <button class="btn" @click="encryptData">加密</button>
      <button class="btn" @click="decryptData">解密</button>
    </view>
  </view>
</template>

<script>


export default {
  name: 'Encrypt',
  data () {
    return {
      text: '非对称加密',
      publicKey: '',
      privateKey: '',
      encryptedString: '',
      decryptedString: '',
      encrypt: new this.$ctmobile.secret.encrypt()
    }
  },
  onShow() {
    // 默认使用全局设置的公钥、私钥
    // eslint-disable-next-line no-undef
    this.publicKey = getApp().globalData.publicKey
    
    // eslint-disable-next-line no-undef
    this.privateKey = getApp().globalData.privateKey
  },
  methods: {
    initKey(){
      this.encrypt.setPublicKey(this.publicKey);
      this.encrypt.setPrivateKey(this.privateKey);
    },
    encryptData(){
      this.encryptedString = ''
      uni.showLoading({
        title: '加密中'
      })
      const result = this.encrypt.encryptLong(this.text)
      this.encryptedString = result ?? '加密失败，请重试';
      uni.showToast({
        title: result ? '加密成功' : '加密失败',
        icon: result ? 'success' : 'error',
      })
    },
    decryptData(){
      this.decryptedString = ''
      uni.showLoading({
        title: '解密中'
      })
      
      const result = this.encrypt.decryptLong(this.encryptedString);
      this.decryptedString = result ?? '解密失败，请重试'
      uni.showToast({
        title: result ? '解密成功' : '解密失败',
        icon: result ? 'success' : 'error',
      })
    }
  }
}
</script>

<style scoped lang="scss">
.demo {
  padding: 20px;

  .title {
    margin: 20px 0;
  }

  .row {
    border: 1px solid #ccc;
    border-radius: 8px;
    padding: 8px;
    margin-bottom: 16px;
  }
  
  .btn {
  	margin-bottom: 8px;
  }

  .result {
    background: red;

    .crypto-text {
      color: #fff;
      word-break: break-all;
    }
  }
  .success {
    background: green;
  }
}
</style>
```

### [对称加密基本使用](http://mid.chinatowercom.cn:18080/appGuide/base/encrypt.html#对称加密基本使用)

- 通过`globalData`设置全局共用加解密密钥
- 通过`需要加密的文本`及`密钥`参数设置要加/解密的字符串

```javascript
// AES-256-ECB 加/解密
// 加密
this.$ctmobile.secret.crypto.AES_ECB_ENCRYPT('加密字符串', '密钥')
// 解密
this.$ctmobile.secret.crypto.AES_ECB_DECRYPT('解密字符串', '密钥')

// AES_CBC 加/解密
// 加密
this.$ctmobile.secret.crypto.AES_CBC_ENCRYPT('加密字符串', '密钥')
// 解密
this.$ctmobile.secret.crypto.AES_CBC_DECRYPT('解密字符串', '密钥')
<template>
  <view class="demo">
    <view class="title">对称加/解密</view>
    <view class="row">
      <text class="label">密钥信息：</text>
      <textarea class="value" v-model="secretKey" placeholder="密钥信息" maxlength="-1" />
    </view>
    <view :class="['row result', {'success': encryptedString}]">
      <view class="crypto-text">加密结果：{{encryptedString}}</view>
    </view>
    <view :class="['row result', {'success': decryptedString}]">
      <view class="crypto-text">解密结果：{{decryptedString}}</view>
    </view>
    <view class="btn-row">
      <button type="primary" class="btn" @click="encryptData('AES-256-ECB')">AES-256-ECB加密</button>
      <button type="warn" class="btn" @click="decryptData('AES-256-ECB')">AES-256-ECB解密</button>
      <button type="primary" class="btn" @click="encryptData('AES-256-CBC')">AES-256-CBC加密</button>
      <button type="warn" class="btn" @click="decryptData('AES-256-CBC')">AES-256-CBC解密</button>
    </view>
  </view>
</template>

<script>


export default {
  name: 'Crypto',
  data () {
    return {
      text: '对称加密',
      secretKey: '',
      encryptedString: '',
      decryptedString: '',
    }
  },
  onShow() {
    // 默认使用全局设置的密钥
    // eslint-disable-next-line no-undef
    this.secretKey = getApp().globalData.secretKey
  },
  methods: {
    encryptData(type = 'AES-256-ECB'){
      this.encryptedString = ''
      uni.showLoading({
        title: '加密中'
      })
      let result = false
      if(type === 'AES-256-ECB'){
        result = this.$ctmobile.secret.crypto.AES_ECB_ENCRYPT(this.text, this.secretKey)
      } else {
        result = this.$ctmobile.secret.crypto.AES_CBC_ENCRYPT(this.text, this.secretKey)
      }
      
      this.encryptedString = result ?? '加密失败，请重试';
      uni.showToast({
        title: result ? '加密成功' : '加密失败',
        icon: result ? 'success' : 'error',
      })
    },
    decryptData(type = 'AES-256-ECB'){
      this.decryptedString = ''
      uni.showLoading({
        title: '解密中'
      })
      
      let result = ''
      if(type === 'AES-256-ECB'){
        result = this.$ctmobile.secret.crypto.AES_ECB_DECRYPT(this.encryptedString, this.secretKey)
      } else {
        result = this.$ctmobile.secret.crypto.AES_CBC_DECRYPT(this.encryptedString, this.secretKey)
      }

      this.decryptedString = result ?? '解密失败，请重试'
      uni.showToast({
        title: result ? '解密成功' : '解密失败',
        icon: result ? 'success' : 'error',
      })
    }
  }
}
</script>

<style scoped lang="scss">
.demo {
  padding: 20px;

  .title {
    margin: 20px 0;
  }

  .row {
    border: 1px solid #ccc;
    border-radius: 8px;
    padding: 8px;
    margin-bottom: 16px;
  }
  
  .btn {
	  margin-bottom: 8px;
  }

  .result {
    background: red;

    .crypto-text {
      color: #fff;
      word-break: break-all;
    }
  }
  .success {
    background: green;
  }
}
</style>
```

### [API](http://mid.chinatowercom.cn:18080/appGuide/base/encrypt.html#api)

#### [非对称加密 Props](http://mid.chinatowercom.cn:18080/appGuide/base/encrypt.html#非对称加密-props)

| 参数         | 说明              | 类型   | 默认值 | 可选值 |
| ------------ | ----------------- | ------ | ------ | ------ |
| text（必填） | 要加/解密的字符串 | String | —      | —      |

#### [对称加密 Props](http://mid.chinatowercom.cn:18080/appGuide/base/encrypt.html#对称加密-props)

| 参数              | 说明              | 类型   | 默认值 | 可选值 |
| ----------------- | ----------------- | ------ | ------ | ------ |
| text（必填）      | 要加/解密的字符串 | String | —      | —      |
| secretKey（必填） | 密钥              | String | —      | —      |
